<body>

</body>
<template name="header">
        <nav class="navbar navbar-default">
            <div class="container-fluid">
                <div class="navbar-header">
                    <a class="navbar-brand" href="#">CSV Upload</a>
                </div>
                <ul class="nav navbar-nav pull-right">
                    <li class="active"><a href="/">Home</a></li>
                    <li class=""><a href="/upload">Upload</a></li>
                    <li><a href="/history">History</a></li>
                    <li>{{> loginButtons}}</li>
                </ul>
            </div>
        </nav>
</template>

<template name="readCSV">
    {{> header}}
    <div class="">
        {{#if currentUser}}
            <div class="container">
                {{> uploadStep}}
            </div>
            {{> EditorPage}}
            <div class="product-file-upload-tab-block">
                <ul class="nav nav-tabs nav-tabs-vertical" role="tablist">
                    {{#each filetypes}}
                        <li role="presentation" class="{{#if isActive}}active{{/if}} {{#if isDone}}done{{/if}}"><a href="#"><i class="fa fa-check-circle-o"></i>{{name}}</a></li>
                    {{/each}}
                </ul>
                <div class="tab-content">
                    <div role="tabpanel" class="tab-pane active">
                        <!--<div> {{previewCollection.length}} </div>
                        <div class="table-responsive">
                            <table class="table table-bordered table-hover">
                                <tbody>
                                    {{#each previewCollection}}
                                        <tr>
                                            {{#each  getJsonValues this}}
                                                <td title="{{this}}"><div> {{this}} </div></td>
                                            {{/each}}
                                        </tr>
                                    {{/each}}     
                                </tbody>
                            </table>
                        </div>-->

                        <div id="upload-csv-zone">
                            <div class="file-zone">
                                <span class="dz-message">Drop files here or click to upload.<br/>
                                    <small>(only csv files are valid.)</small>
                                </span>
                                <div class="dz-spinner">
                                    {{> spinner}}
                                </div>
                                <input type="file" id="csv-file" name="files" accept=".csv"/>
                            </div>
                            
                        </div>
                        <div class="clearfix"></div>
                        <!--<button type="submit" class="btn btn-primary btnReadCsv">Read</button>-->
                        <div id="preview"  class="row" style="display: none;">
                            <div class="col-md-12">
                                <div class="pull-left">
                                    <h3 style="margin-top: 0px;">Preview</h3>
                                </div>
                                <div class="pull-left">
                                    {{> spinner}}
                                </div>
                            </div>
                            <div class="col-md-12">
                                <div class="table-responsive" style="margin-bottom: 10px;border-right: 1px solid #ccc;">
                                    {{#if previewRec.length}}
                                        <table class="table table-bordered table-hover">
                                            <thead>
                                                <tr>
                                                    {{#each getJsonKeys previewRec.[0]}}
                                                        <th>
                                                            {{this}}
                                                        </th>
                                                    {{/each}}
                                                </tr>
                                            </thead>
                                            <tbody>
                                                {{#each previewRec}}
                                                    <tr>
                                                        {{#each  getJsonValues this}}
                                                            <td title="{{this}}"><div> {{this}} </div></td>
                                                        {{/each}}
                                                    </tr>
                                                {{/each}}
                                            </tbody>
                                        </table>
                                    {{/if}}
                                    <!--{{> reactiveTable  class="table table-bordered table-hover" multiColumnSort='false' showNavigation='never' showFilter=false collection=previewRec }}-->
                                </div>
                            </div>
                            <div class="col-md-12">
                                <label>
                                    <input type="checkbox" id="hasheader" checked="checked" /> Has header
                                </label>
                                <button id="btnNext" style="margin-left:5px;" class="progress-button progress-button-small pull-right" data-style="top-line" data-horizontal="">
                                    <span class="content">Proceed</span>
                                    <span class="progress">
                                        <span class="progress-inner notransition" style="width: 0%; opacity: 1;"></span>
                                    </span>
                                </button>
                                {{> buttonAbort}}
                            </div>
                        </div>
                        <div class="clearfix"></div>
                        <div id="handson-Zone-during-upload">
                            <div class="handson-table">
                                <div id="hotErrorDataDuringUpload"></div>
                            </div>
                            <span id="errMessageFromSchema" class="pull-left text-danger"></span>
                            <button style="margin-left:5px;" class="progress-button progress-button-small pull-right" id="buttonProceedNext" data-style="top-line" data-horizontal="">
                                <span class="content">Proceed To Next</span>
                                <span class="progress">
                                    <span class="progress-inner notransition" style="width: 0%; opacity: 1;"></span>
                                </span>
                            </button>
                            {{> buttonAbort}}
                        </div>
                        <div class="clearfix"></div>
                        <div class="row">
                            <div id="mapping" class="col-md-12" style="display: none;">
                                <div class="pull-left">
                                    <h3>Headers mapping</h3>
                                </div>
                                <div class="pull-left">
                                    {{> spinner}}
                                </div>
                                <div class="view-mapping">
                                    <table class="table table-bordered table-striped">
                                        <thead>
                                            <tr>
                                                <th>Column Index</th>
                                                <th>CSV header</th>
                                                <th>System headers</th>
                                                <th>Transform</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            {{#each csvHeaders}}
                                                <tr>
                                                    {{#let rowIndex=@index}}
                                                        <td style="width: 12%" class="text-center">{{rowIndex}}</td>
                                                        <td style="width: 30%">
                                                            <span id="dpdcsvheader_{{rowIndex}}"  selected="selected" data-column="{{this}}" style="text-transform:capitalize">{{this}}</span>
                                                            <!--<span id="dpdsysheader_{{rowIndex}}"  selected="selected" data-column="{{column}}" style="text-transform:capitalize">{{text}}</span>-->
                                                        </td>
                                                        <td style="width: 30%">
                                                            <a href="#" id="dpdsysheader_{{rowIndex}}" class="dpdsysheader" data-type="select" data-inputclass="form-control"></a>
                                                            <!--<a href="#" id="dpdcsvheader_{{rowIndex}}" data-type="select" data-inputclass="form-control"></a>-->
                                                        </td>
                                                        <td style="width: 30%">
                                                            <!-- Trigger the modal with a button -->
                                                            <a href="#" id="txtCustomJavascript_{{rowIndex}}" data-toggle="modal" data-target="#javascripEditorModal" data-header="{{column}}" data-code="" title="Click here to add code." style="float: left;"><i class="fa fa-pencil-square-o"></i></a>
                                                            <div class="transform-function"></div>
                                                            <!--<a href="#" id="dpddatatype_{{rowIndex}}" data-type="select" data-inputclass="form-control"></a>-->
                                                        </td>
                                                    {{/let}}
                                                </tr>
                                            {{/each}}
                                            <tr>
                                                <td colspan="3" style="text-align: center;">
                                                    <a href="#" id="addNewHeader">Add new</a>
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                        <!--<table  class="table table-bordered">
                            <thead>
                                <tr>
                                    <th>
                                        File name
                                    </th>
                                    <th style="width: 150px;">
                                        Progress
                                    </th>
                                </tr>
                            </thead>
                            <tbody>
                                {{#each files}}
                                    <tr>
                                        <td>
                                            {{name}}
                                        </td>
                                        <td >
                                            <div class="progress">
                                                <div class="progress-bar progress-bar-success progress-bar-striped" role="progressbar"
                                                aria-valuenow="{{progress}}" aria-valuemin="0" aria-valuemax="100" style="width: {{progress}}%">
                                                    {{progress}}%
                                                </div>
                                            </div>
                                        </td>
                                    </tr>
                                {{/each}}
                            </tbody>
                        </table>-->

                    </div>
                </div>
            </div>
        {{/if}}
     </div>
</template>


<template name="spinner">
    <div class="sk-wave spinner">
        <div class="sk-rect sk-rect1"></div>
        <div class="sk-rect sk-rect2"></div>
        <div class="sk-rect sk-rect3"></div>
        <div class="sk-rect sk-rect4"></div>
        <div class="sk-rect sk-rect5"></div>
    </div>
</template>

<template name="uploadStep">
    <div id="steps-block" class="step-progress">
        <ol class="progress">
            <li class="is-active" data-step="1"> <a href="/upload"> Upload </a> </li>
            <li data-step="2"> <a href="/validation"> Validate </a> </li>
            <li data-step="3" class="progress__last"> <a href="/import"> Import </a> </li>
        </ol>
    </div>
</template>


<template name="buttonAbort">
    <button style="display: none;" class="progress-button progress-button-small progress-button-danger pull-right" id="btnAbort" data-style="top-line" data-horizontal="">
        <span class="content">Abort</span>
        <span class="progress">
            <span class="progress-inner notransition" style="width: 0%; opacity: 1;"></span>
        </span>
    </button>
</template>

<template name="EditorPage">
    <!-- Modal -->
    <div id="javascripEditorModal" class="modal fade" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal">&times;</button>
                <h4 class="modal-title">Write your custom javascript</h4>
            </div>
            <div class="modal-body">
                <textarea id="customJavascript" name="customJavascript"></textarea>
                <!--{{> CodeMirror id="customJavascript" name="customJavascript" options=editorOptions code=editorCode}}-->
            </div>
            <div class="modal-footer">
                <button id="btnSaveCustomjavascript" type="button" class="progress-button progress-button-small">Save</button>
            </div>
            </div>
        </div>
    </div>
</template>